{% extends "base.html" %}

{% block title %}Користувач: {{ u.username }}{% endblock %}

{% block content %}
<div class="row" style="margin-top: 4px;">

  <!-- header -->
  <div class="col s12">
    <div class="card">
      <div class="card-content">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
          <span class="card-title">Користувач: {{ u.username }}</span>

          <a class="btn grey" href="{% url 'admin_users' %}">
            Назад <i class="material-icons right">arrow_back</i>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- left: profile -->
  <div class="col s12 m5">
    <div class="card">
      <div class="card-content">
        <span class="card-title">Профіль</span>

        {% if error %}
          <div class="card-panel red lighten-5 red-text text-darken-4">
            {{ error }}
          </div>
        {% endif %}

        {% if saved %}
          <div class="card-panel green lighten-5 green-text text-darken-4">
            Збережено
          </div>
        {% endif %}

        <form method="post">
          {% csrf_token %}

          <div class="input-field">
            <input id="email" name="email" type="email" value="{{ u.email }}">
            <label for="email" class="{% if u.email %}active{% endif %}">Email</label>
          </div>

          <div class="input-field">
            <input id="first_name" name="first_name" type="text" value="{{ u.first_name }}">
            <label for="first_name" class="{% if u.first_name %}active{% endif %}">Ім'я</label>
          </div>

          <div class="input-field">
            <input id="last_name" name="last_name" type="text" value="{{ u.last_name }}">
            <label for="last_name" class="{% if u.last_name %}active{% endif %}">Прізвище</label>
          </div>

          <p style="margin-top: 6px;">
            <label>
              <input type="checkbox" name="is_staff" {% if u.is_staff %}checked{% endif %}>
              <span>Staff (доступ до адмін-розділів)</span>
            </label>
          </p>

          <div style="margin-top:16px;">
            <button class="btn waves-effect waves-light" type="submit">
              Зберегти <i class="material-icons right">save</i>
            </button>
          </div>
        </form>

        <!-- quick info -->
        <div style="margin-top:12px;">
          <p class="grey-text" style="margin:0;">
            Username: <b>{{ u.username }}</b><br>
            Active: <b>{{ u.is_active }}</b><br>
            Last login: <b>{{ u.last_login|default:"—" }}</b>
          </p>
        </div>

      </div>
    </div>
  </div>

  <!-- right: actions -->
  <div class="col s12 m7">
    <div class="card">
      <div class="card-content">
        <span class="card-title">Дії</span>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">

          <form method="post" action="{% url 'admin_user_toggle_active' u.id %}" style="margin:0;">
            {% csrf_token %}
            {% if u.is_active %}
              <button class="btn red waves-effect waves-light" type="submit">
                Деактивувати <i class="material-icons right">block</i>
              </button>
            {% else %}
              <button class="btn green waves-effect waves-light" type="submit">
                Активувати <i class="material-icons right">check</i>
              </button>
            {% endif %}
          </form>

          <a class="btn" href="{% url 'admin_user_set_password' u.id %}">
            Змінити пароль <i class="material-icons right">vpn_key</i>
          </a>

        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}
